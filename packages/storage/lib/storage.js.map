{"version":3,"file":"storage.js","sources":["../src/controllers/index.ts","../src/controllers/localStorage.ts","../src/controllers/sessionStorage.ts","../src/controllers/cookie.ts","../src/index.ts"],"sourcesContent":["const CryptoJS = require('crypto-js');\n\nimport { StorageManagerProps } from '../const';\n\nexport default class StorageManager {\n  protected secret: string;\n  protected encryption: boolean;\n\n  constructor(props: StorageManagerProps) {\n    this.secret = 'cool-digtal';\n    this.encryption = props?.encryption;\n  }\n\n  protected encrypted(values) {\n    return CryptoJS.AES.encrypt(encodeURIComponent(JSON.stringify(values)), this.secret).toString();\n  }\n\n  protected decrypted(session) {\n    return CryptoJS.AES.decrypt(session, this.secret).toString(CryptoJS.enc.Utf8);\n  }\n\n  public setStorage(key, values, options?) {\n  }\n\n  public getStorage(key, defaultValue?) {\n  }\n\n  public removeStorage(key) {\n  }\n\n}\n","import { set, get } from 'lodash';\nimport StorageManager from './index';\n\n\nexport default class LocalStorage extends StorageManager {\n  constructor(props?) {\n    super({encryption: props?.encryption || false});\n  }\n\n  private setItem(key, value) {\n    if (this.encryption) {\n      localStorage.setItem(key, this.encrypted(value));\n    } else {\n      localStorage.setItem(key, JSON.stringify(value));\n    }\n  }\n\n   public setStorage(key, values) {\n    const names = key.split('.');\n    if (names.length > 1) {\n      const [ parentName, ...otherNames ] = names;\n      const oldValue = this.getStorage(parentName) || {};\n      set(oldValue, otherNames.join('.'), values);\n      this.setItem(parentName, oldValue);\n    } else {\n      this.setItem(key, values);\n    }\n  }\n\n  public getStorage(key) {\n    const name = key.split('.');\n    const [ parent, ...otherNames ] = name;\n    const session = localStorage.getItem(parent);\n    if (session) {\n      let result = this.encryption ? this.decrypted(session) : session;\n      try {\n        result = JSON.parse(decodeURIComponent(result));\n        return name.length > 1 ? get(result, otherNames.join('.')) : result;\n      } catch(e) {\n        return result\n      }\n    }\n  }\n\n  public removeStorage(key) {\n    localStorage.removeItem(key);\n  }\n}\n","import { set, get } from 'lodash';\nimport StorageManager from './index';\n\n\nexport default class SessionStorage extends StorageManager {\n  constructor(props?) {\n    super({encryption: props?.encryption || false});\n  }\n\n  private setItem(key, value) {\n    if (this.encryption) {\n      sessionStorage.setItem(key, this.encrypted(value));\n    } else {\n      sessionStorage.setItem(key, JSON.stringify(value));\n    }\n  }\n\n   public setStorage(key, values) {\n    const names = key.split('.');\n    if (names.length > 1) {\n      const [ parentName, ...otherNames ] = names;\n      const oldValue = this.getStorage(parentName) || {};\n      set(oldValue, otherNames.join('.'), values);\n      this.setItem(parentName, oldValue);\n    } else {\n      this.setItem(key, values);\n    }\n  }\n\n  public getStorage(key) {\n    const name = key.split('.');\n    const [ parent, ...otherNames ] = name;\n    const session = sessionStorage.getItem(parent);\n    if (session) {\n      let result = this.encryption ? this.decrypted(session) : session;\n      try {\n        result = JSON.parse(decodeURIComponent(result));\n        return name.length > 1 ? get(result, otherNames.join('.')) : result;\n      } catch(e) {\n        return result\n      }\n    }\n  }\n\n  public removeStorage(key) {\n    sessionStorage.removeItem(key);\n  }\n}\n","import { set, get } from 'lodash';\n// import Cookies from 'js-cookie';\nconst Cookies = require('js-cookie');\nimport StorageManager from './index';\n\n\nexport default class CookieStorage extends StorageManager {\n  constructor(props?) {\n    super({encryption: false});\n  }\n\n\n   private setItem(key, value, options?) {\n    if (this.encryption) {\n      Cookies.set(key, this.encrypted(value), options)\n    } else {\n      Cookies.set(key, JSON.stringify(value), options)\n    }\n  }\n\n   public setStorage(key, values) {\n    const names = key.split('.');\n    if (names.length > 1) {\n      const [ parentName, ...otherNames ] = names;\n      const oldValue = this.getStorage(parentName) || {};\n      set(oldValue, otherNames.join('.'), values);\n      this.setItem(parentName, oldValue);\n    } else {\n      this.setItem(key, values);\n    }\n  }\n\n  public getStorage (key, defaultValue?) {\n    const name = key.split('.');\n    const [ parent, ...otherNames ] = name;\n    const session = Cookies.get(parent);\n    if (session) {\n      let result = this.encryption ? this.decrypted(session) : session;\n      try {\n        result = JSON.parse(decodeURIComponent(result));\n        return name.length > 1 ? get(result, otherNames.join('.')) : result;\n      } catch(e) {\n        return result\n      }\n    }\n  }\n\n  public removeStorage (key) {\n    Cookies.remove(key)\n    return ''\n  }\n}\n","import LocalStorage from './controllers/localStorage';\nimport SessionStorage from './controllers/sessionStorage';\nimport CookieStorage from './controllers/cookie';\n\nexport const Local = new LocalStorage();\nexport const encryptionLocal = new LocalStorage({encryption: true});\n\nexport const sessionLocal = new SessionStorage();\nexport const encryptionSessionLocal = new SessionStorage({encryption: true});\n\n\nexport const cookieLocal = new CookieStorage();\nexport const encryptionCookieLocal = new CookieStorage({encryption: true});\n"],"names":["set","get"],"mappings":"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"}